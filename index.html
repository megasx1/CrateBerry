<!DOCtype HTML>
<html> 
	
	<head>
		<title>Welcome to Crate Berry a samplers paradise</title>

		<style type="text/css">
			body{
				background-color:#000;
			}
		</style>
	</head>
	<body> 
        

		<div class="topnav" id="mytopnav">
			<a href="index.html">home page</a>
			<a href="aboutus.html">about us</a>
			<a href="contactpage.html">Contact</a>
            <a href="catalogpage.html">catalog</a>
            <input type="search" name="googlesearch">
            <input type="submit">

		</div>
        
        <select id="catagories">
            <option value="horns"> horns</option>
            <option value="drumloops">drum loops</option>
            <option value="melodies"> melodies</option>
        </select>
        <input id="uploader" type="file" onchange="upload()">

        <script src="https://www.gstatic.com/firebasejs/3.8.0/firebase.js"></script>
        <script>
          // Initialize Firebase
          var config = {
            apiKey: "AIzaSyCRMUmqbnnwDb1RkVyMUApKMq9lu6Ayf5E",
            authDomain: "crate-berry.firebaseapp.com",
            databaseURL: "https://crate-berry.firebaseio.com",
            projectId: "crate-berry",
            storageBucket: "crate-berry.appspot.com",
            messagingSenderId: "944150635959"
          };
          firebase.initializeApp(config); 
            
            function upload(){
                var files = document.getElementById("uploader").files;
                var catagory = document.getElementById("catagories");
                var uploadTask = firebase.storage().ref("music/" + catagory.value + "/" + files[0].name).put(files[0]);

                uploadTask.on(firebase.storage.TaskEvent.STATE_CHANGED, 
                             function(snapshot){},
                             function(error){},
                             function(){
                                 var filename = uploadTask.snapshot.metadata.name;
                                 var downloadURL= uploadTask.snapshot.downloadURL; 

                                 firebase.database().ref("music/" + catagory.value + "/" +filename.substr(0, filename.length-4) ).set({
                                     URL: downloadURL,
                                     name: filename
                                 });
                           } 
                );
            }
        </script> 

        
	</body>

</html>

